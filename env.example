# Heliox Proxy Configuration
# Copy this file to .env and configure for your environment

# =============================================================================
# DATABASE
# =============================================================================
DATABASE_URL=postgresql+asyncpg://heliox:heliox_password@localhost:5432/heliox
DATABASE_URL_SYNC=postgresql://heliox:heliox_password@localhost:5432/heliox

# =============================================================================
# REDIS
# =============================================================================
# Set to empty string to enable Demo Mode (in-memory fallback)
REDIS_URL=redis://localhost:6379/0

# =============================================================================
# APPLICATION
# =============================================================================
SECRET_KEY=your-secret-key-change-in-production
ADMIN_API_KEY=admin-secret-key-change-me
DEBUG=true
LOG_LEVEL=INFO

# =============================================================================
# GATEWAY SETTINGS
# =============================================================================
# Default timeout for upstream requests (ms)
DEFAULT_UPSTREAM_TIMEOUT_MS=30000

# Maximum body size to cache (bytes)
MAX_CACHE_BODY_SIZE=10485760

# =============================================================================
# RATE LIMITING
# =============================================================================
# Default rate limit per key (requests per second)
DEFAULT_RATE_LIMIT_RPS=100

# Default burst size
DEFAULT_RATE_LIMIT_BURST=200

# =============================================================================
# ABUSE DETECTION
# =============================================================================
# EWMA decay factor (0-1, higher = more weight on recent)
ABUSE_EWMA_ALPHA=0.3

# Z-score threshold for anomaly detection
ABUSE_ZSCORE_THRESHOLD=3.0

# Soft block duration (seconds)
ABUSE_BLOCK_DURATION_SECONDS=300

# =============================================================================
# BLOOM FILTER (Negative Caching)
# =============================================================================
# Expected number of 404 paths
BLOOM_EXPECTED_ITEMS=10000

# Desired false positive rate
BLOOM_FALSE_POSITIVE_RATE=0.01

# =============================================================================
# CELERY / WORKER
# =============================================================================
CELERY_BROKER_URL=redis://localhost:6379/1
CELERY_RESULT_BACKEND=redis://localhost:6379/1

# =============================================================================
# CORS (for Admin UI)
# =============================================================================
CORS_ORIGINS=http://localhost:3000,http://localhost:3001

# =============================================================================
# DEPLOYMENT MODE
# =============================================================================
# full | demo
DEPLOYMENT_MODE=full

# Auto-seed database with sample data on startup
AUTO_SEED=true

# =============================================================================
# EXTERNAL SERVICES (for free tier deployments)
# =============================================================================
# Neon/Supabase Postgres
# NEON_DATABASE_URL=

# Upstash Redis
# UPSTASH_REDIS_URL=

# =============================================================================
# ADMIN UI
# =============================================================================
NEXT_PUBLIC_API_URL=http://localhost:8000
